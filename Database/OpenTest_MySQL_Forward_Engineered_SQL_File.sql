SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

CREATE SCHEMA IF NOT EXISTS `OpenTestCenterDB` DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci ;
USE `OpenTestCenterDB` ;

-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`User`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`User` (
  `UserID` INT NOT NULL ,
  `FName` VARCHAR(45) NOT NULL ,
  `LName` VARCHAR(45) NULL ,
  `Email` VARCHAR(45) NULL ,
  `IM` VARCHAR(45) NULL ,
  `KnownAs` VARCHAR(45) NULL ,
  `Thumbnail` BLOB NULL ,
  PRIMARY KEY (`UserID`) )
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`Department`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`Department` (
  `DeptID` INT NOT NULL ,
  `Desc` VARCHAR(64) NULL ,
  `RP` INT NULL ,
  PRIMARY KEY (`DeptID`) ,
  INDEX `RP_idx` (`RP` ASC) ,
  UNIQUE INDEX `DeptID_UNIQUE` (`DeptID` ASC) ,
  CONSTRAINT `RP_for_Dept`
    FOREIGN KEY (`RP` )
    REFERENCES `OpenTestCenterDB`.`User` (`UserID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`BusinessUnit`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`BusinessUnit` (
  `BusinessUnitID` INT NOT NULL ,
  `Desc` VARCHAR(45) NULL ,
  `DeptID` INT NULL ,
  `RP` INT NOT NULL ,
  PRIMARY KEY (`BusinessUnitID`) ,
  INDEX `RP_idx` (`RP` ASC) ,
  INDEX `Dept_for_BU_idx` (`DeptID` ASC) ,
  UNIQUE INDEX `BusinessUnitID_UNIQUE` (`BusinessUnitID` ASC) ,
  CONSTRAINT `RP_for_BU`
    FOREIGN KEY (`RP` )
    REFERENCES `OpenTestCenterDB`.`User` (`UserID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `Dept_for_BU`
    FOREIGN KEY (`DeptID` )
    REFERENCES `OpenTestCenterDB`.`Department` (`DeptID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`Team`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`Team` (
  `TeamID` INT NOT NULL ,
  `Desc` VARCHAR(45) NULL ,
  `BusinessUnitID` INT NULL ,
  `RP` INT NOT NULL ,
  PRIMARY KEY (`TeamID`) ,
  INDEX `BusinessUnitID_idx` (`BusinessUnitID` ASC) ,
  INDEX `RP_idx` (`RP` ASC) ,
  UNIQUE INDEX `TeamID_UNIQUE` (`TeamID` ASC) ,
  CONSTRAINT `BU_for_Team`
    FOREIGN KEY (`BusinessUnitID` )
    REFERENCES `OpenTestCenterDB`.`BusinessUnit` (`BusinessUnitID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `RP_for_Team`
    FOREIGN KEY (`RP` )
    REFERENCES `OpenTestCenterDB`.`User` (`UserID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`Product`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`Product` (
  `ProductID` INT NOT NULL ,
  `BusinessUnitID` INT NULL ,
  `RP` INT NOT NULL ,
  PRIMARY KEY (`ProductID`) ,
  INDEX `BusinessUnitID_idx` (`BusinessUnitID` ASC) ,
  INDEX `RP_idx` (`RP` ASC) ,
  CONSTRAINT `BusinessUnit_for_Product`
    FOREIGN KEY (`BusinessUnitID` )
    REFERENCES `OpenTestCenterDB`.`BusinessUnit` (`BusinessUnitID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `RP_for_Product`
    FOREIGN KEY (`RP` )
    REFERENCES `OpenTestCenterDB`.`User` (`UserID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`SubTeam`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`SubTeam` (
  `SubTeamID` INT NOT NULL ,
  `TeamID` INT NULL ,
  `Desc` VARCHAR(45) NULL ,
  `Thumbnail` BLOB NULL ,
  `RP` INT NULL ,
  PRIMARY KEY (`SubTeamID`) ,
  INDEX `TeamID_idx` (`TeamID` ASC) ,
  UNIQUE INDEX `SubTeamID_UNIQUE` (`SubTeamID` ASC) ,
  INDEX `RP_idx` (`RP` ASC) ,
  CONSTRAINT `TeamID_parent_of_Subteam`
    FOREIGN KEY (`TeamID` )
    REFERENCES `OpenTestCenterDB`.`Team` (`TeamID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `RP_of_Subteam`
    FOREIGN KEY (`RP` )
    REFERENCES `OpenTestCenterDB`.`User` (`UserID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`Release`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`Release` (
  `ReleaseID` INT NOT NULL ,
  `ProductID` INT NULL ,
  `TeamID` INT NULL ,
  `SubTeamID` INT NULL ,
  `RP` INT NOT NULL ,
  `Name` VARCHAR(45) NULL ,
  `Desc` VARCHAR(1024) NULL ,
  `Version` VARCHAR(45) NULL ,
  PRIMARY KEY (`ReleaseID`) ,
  INDEX `ProductID_idx` (`ProductID` ASC) ,
  INDEX `TeamID_idx` (`TeamID` ASC) ,
  INDEX `SubTeamID_idx` (`SubTeamID` ASC) ,
  INDEX `RP_idx` (`RP` ASC) ,
  CONSTRAINT `Product_for_Release`
    FOREIGN KEY (`ProductID` )
    REFERENCES `OpenTestCenterDB`.`Product` (`ProductID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `Team_supporting_Release`
    FOREIGN KEY (`TeamID` )
    REFERENCES `OpenTestCenterDB`.`Team` (`TeamID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `SubTeam_supporting_Release`
    FOREIGN KEY (`SubTeamID` )
    REFERENCES `OpenTestCenterDB`.`SubTeam` (`SubTeamID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `RP_for_Release`
    FOREIGN KEY (`RP` )
    REFERENCES `OpenTestCenterDB`.`User` (`UserID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`Build`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`Build` (
  `BuildID` INT NOT NULL ,
  `BuildName` VARCHAR(45) NULL ,
  `RP` INT NOT NULL ,
  `DeliveredOn` DATETIME NOT NULL ,
  `ExpectedOn` DATETIME NULL ,
  `SubTeamID` INT NULL ,
  `ShortDesc` VARCHAR(128) NULL ,
  PRIMARY KEY (`BuildID`) ,
  INDEX `SubTeamID_idx` (`SubTeamID` ASC) ,
  INDEX `RP_for_build_idx` (`RP` ASC) ,
  UNIQUE INDEX `BuildID_UNIQUE` (`BuildID` ASC) ,
  CONSTRAINT `SubTeam_delivering_Build`
    FOREIGN KEY (`SubTeamID` )
    REFERENCES `OpenTestCenterDB`.`SubTeam` (`SubTeamID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `RP_for_build`
    FOREIGN KEY (`RP` )
    REFERENCES `OpenTestCenterDB`.`User` (`UserID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`Payload`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`Payload` (
  `PayloadID` INT NOT NULL ,
  `PayloadName` VARCHAR(128) NOT NULL ,
  `RP` INT NULL ,
  `DeliveredOn` DATETIME NULL ,
  `ExpectedOn` DATETIME NULL ,
  `SubTeamID` INT NULL ,
  `ShortDesc` VARCHAR(255) NULL ,
  `LongDesc` VARCHAR(1024) NULL ,
  `AssociatedBuild` INT NULL ,
  PRIMARY KEY (`PayloadID`) ,
  UNIQUE INDEX `PayloadID_UNIQUE` (`PayloadID` ASC) ,
  INDEX `RP_for_Payload_idx` (`RP` ASC) ,
  INDEX `SubTeam_owning_Payload_idx` (`SubTeamID` ASC) ,
  INDEX `Build_containing_PL_idx` (`AssociatedBuild` ASC) ,
  CONSTRAINT `RP_for_Payload`
    FOREIGN KEY (`RP` )
    REFERENCES `OpenTestCenterDB`.`User` (`UserID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `SubTeam_owning_Payload`
    FOREIGN KEY (`SubTeamID` )
    REFERENCES `OpenTestCenterDB`.`SubTeam` (`SubTeamID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `Build_containing_PL`
    FOREIGN KEY (`AssociatedBuild` )
    REFERENCES `OpenTestCenterDB`.`Build` (`BuildID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`Suite`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`Suite` (
  `SuiteID` INT NOT NULL ,
  `ProductID` INT NULL ,
  `Name` VARCHAR(128) NOT NULL ,
  `Description` VARCHAR(1024) NULL ,
  `CreatedOn` DATETIME NULL ,
  `LastRun` DATETIME NULL ,
  `AuthorID` INT NOT NULL ,
  `RP` INT NOT NULL ,
  PRIMARY KEY (`SuiteID`) ,
  INDEX `ProductID_idx` (`ProductID` ASC) ,
  INDEX `AuthorID_idx` (`AuthorID` ASC) ,
  INDEX `OwnerID_idx` (`RP` ASC) ,
  UNIQUE INDEX `SuiteID_UNIQUE` (`SuiteID` ASC) ,
  CONSTRAINT `Product_for_Suite`
    FOREIGN KEY (`ProductID` )
    REFERENCES `OpenTestCenterDB`.`Product` (`ProductID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `Author_of_Suite`
    FOREIGN KEY (`AuthorID` )
    REFERENCES `OpenTestCenterDB`.`User` (`UserID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `RP_for_Suite`
    FOREIGN KEY (`RP` )
    REFERENCES `OpenTestCenterDB`.`User` (`UserID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`TestMode`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`TestMode` (
  `TestModeID` INT NOT NULL ,
  `Name` VARCHAR(45) NOT NULL ,
  `Description` VARCHAR(255) NULL ,
  PRIMARY KEY (`TestModeID`) ,
  UNIQUE INDEX `TestModeID_UNIQUE` (`TestModeID` ASC) )
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`Priority`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`Priority` (
  `PriorityID` INT NOT NULL ,
  `Name` VARCHAR(45) NULL ,
  `Value` INT NULL ,
  PRIMARY KEY (`PriorityID`) ,
  UNIQUE INDEX `PriorityID_UNIQUE` (`PriorityID` ASC) )
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`PassValue`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`PassValue` (
  `PassValueID` INT NOT NULL ,
  `Name` VARCHAR(45) NOT NULL ,
  PRIMARY KEY (`PassValueID`) ,
  UNIQUE INDEX `PassValueID_UNIQUE` (`PassValueID` ASC) )
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`Test`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`Test` (
  `TestID` INT NOT NULL ,
  `TestModeID` INT NULL ,
  `Name` VARCHAR(255) NOT NULL ,
  `PriorityID` INT NULL ,
  `CreatedOn` DATETIME NOT NULL ,
  `LastRun` DATETIME NULL ,
  `ReviewedOn` DATETIME NULL ,
  `AuthorID` INT NULL ,
  `PassValue` INT NULL ,
  PRIMARY KEY (`TestID`) ,
  INDEX `TestModeID_idx` (`TestModeID` ASC) ,
  INDEX `PriorityID_idx` (`PriorityID` ASC) ,
  INDEX `PassValueID_idx` (`PassValue` ASC) ,
  INDEX `Author_idx` (`AuthorID` ASC) ,
  UNIQUE INDEX `TestID_UNIQUE` (`TestID` ASC) ,
  CONSTRAINT `TestMode_for_Test`
    FOREIGN KEY (`TestModeID` )
    REFERENCES `OpenTestCenterDB`.`TestMode` (`TestModeID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `Priority_for_Test`
    FOREIGN KEY (`PriorityID` )
    REFERENCES `OpenTestCenterDB`.`Priority` (`PriorityID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `PassValue_for_Test`
    FOREIGN KEY (`PassValue` )
    REFERENCES `OpenTestCenterDB`.`PassValue` (`PassValueID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `Author_for_Test`
    FOREIGN KEY (`AuthorID` )
    REFERENCES `OpenTestCenterDB`.`User` (`UserID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`Story`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`Story` (
  `StoryID` INT NOT NULL ,
  `ShortDesc` VARCHAR(45) NULL ,
  `LongDesc` VARCHAR(255) NULL ,
  `AuthorID` INT NULL ,
  `OwnerID` INT NULL ,
  `CreatedOn` DATETIME NULL ,
  `Size` INT NULL ,
  `State` VARCHAR(45) NULL ,
  `RP` INT NOT NULL ,
  PRIMARY KEY (`StoryID`) ,
  INDEX `RP_of_story_idx` (`RP` ASC) ,
  CONSTRAINT `RP_of_story`
    FOREIGN KEY (`RP` )
    REFERENCES `OpenTestCenterDB`.`User` (`UserID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`AcceptanceCriterion`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`AcceptanceCriterion` (
  `ACID` INT NOT NULL ,
  `StoryID` INT NULL ,
  `LocalOrderID` INT NULL ,
  `Title` VARCHAR(128) NULL ,
  `Desc` VARCHAR(4095) NULL ,
  PRIMARY KEY (`ACID`) ,
  INDEX `StoryID_idx` (`StoryID` ASC) ,
  CONSTRAINT `Story_holding_AC`
    FOREIGN KEY (`StoryID` )
    REFERENCES `OpenTestCenterDB`.`Story` (`StoryID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`Step`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`Step` (
  `StepID` INT NOT NULL ,
  `LocalOrderID` INT NOT NULL ,
  `Condition` VARCHAR(1024) NOT NULL ,
  `ExpValue` VARCHAR(255) NULL ,
  `CurrentPassValue` INT NULL ,
  `LastPassValue` INT NULL ,
  `ParentTest` INT NOT NULL ,
  PRIMARY KEY (`StepID`) ,
  UNIQUE INDEX `StepID_UNIQUE` (`StepID` ASC) ,
  INDEX `Parent_idx` (`ParentTest` ASC) ,
  INDEX `PassValue_idx` (`CurrentPassValue` ASC) ,
  CONSTRAINT `Test_which_step_belongs_to`
    FOREIGN KEY (`ParentTest` )
    REFERENCES `OpenTestCenterDB`.`Test` (`TestID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `Last_PassValue_of_Step`
    FOREIGN KEY (`CurrentPassValue` )
    REFERENCES `OpenTestCenterDB`.`PassValue` (`PassValueID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`TriageState`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`TriageState` (
  `TriageID` INT NOT NULL ,
  `LocalTriageID` INT NULL ,
  `TriageName` VARCHAR(45) NOT NULL ,
  `Comments` VARCHAR(128) NULL ,
  PRIMARY KEY (`TriageID`) )
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`Bug`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`Bug` (
  `BugID` INT NOT NULL ,
  `ShortDesc` VARCHAR(45) NOT NULL ,
  `LongDesc` VARCHAR(255) NULL ,
  `OpenedOn` DATETIME NULL ,
  `ClosedOn` DATETIME NULL ,
  `Author` INT NOT NULL ,
  `OriginatingTestStepID` INT NULL ,
  `CurrentPassValue` INT NOT NULL ,
  `RP` INT NOT NULL ,
  `TriageState` INT NULL ,
  PRIMARY KEY (`BugID`) ,
  INDEX `AuthorID_idx` (`Author` ASC) ,
  UNIQUE INDEX `BugID_UNIQUE` (`BugID` ASC) ,
  INDEX `Test_Step_Which_Found_Bug_idx` (`OriginatingTestStepID` ASC) ,
  INDEX `Current_Bug_Passvalue_idx` (`CurrentPassValue` ASC) ,
  INDEX `Triage_State_for_Bug_idx` (`TriageState` ASC) ,
  INDEX `RP_for_Bug_idx` (`RP` ASC) ,
  CONSTRAINT `Author_of_Bug`
    FOREIGN KEY (`Author` )
    REFERENCES `OpenTestCenterDB`.`User` (`UserID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `Test_Step_Which_Found_Bug`
    FOREIGN KEY (`OriginatingTestStepID` )
    REFERENCES `OpenTestCenterDB`.`Step` (`StepID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `Current_Bug_Passvalue`
    FOREIGN KEY (`CurrentPassValue` )
    REFERENCES `OpenTestCenterDB`.`PassValue` (`PassValueID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `Triage_State_for_Bug`
    FOREIGN KEY (`TriageState` )
    REFERENCES `OpenTestCenterDB`.`TriageState` (`TriageID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `RP_for_Bug`
    FOREIGN KEY (`RP` )
    REFERENCES `OpenTestCenterDB`.`User` (`UserID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`SetType`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`SetType` (
  `SetTypeID` INT NOT NULL ,
  `Name` VARCHAR(45) NULL ,
  PRIMARY KEY (`SetTypeID`) ,
  UNIQUE INDEX `SetTypeID_UNIQUE` (`SetTypeID` ASC) )
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`SuiteMap`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`SuiteMap` (
  `TSMapID` INT NOT NULL ,
  `SuiteID` INT NOT NULL ,
  `TestID` INT NOT NULL ,
  `TestPriorityInSuite` INT NULL ,
  `AuthorOrder` INT NULL ,
  PRIMARY KEY (`TSMapID`) ,
  INDEX `TestID_idx` (`TestID` ASC) ,
  INDEX `SuiteID_idx` (`SuiteID` ASC) ,
  INDEX `Priority_in_Suite_idx` (`TestPriorityInSuite` ASC) ,
  UNIQUE INDEX `TSMapID_UNIQUE` (`TSMapID` ASC) ,
  CONSTRAINT `Test_in_Suite`
    FOREIGN KEY (`TestID` )
    REFERENCES `OpenTestCenterDB`.`Test` (`TestID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `Suite_containing_Test`
    FOREIGN KEY (`SuiteID` )
    REFERENCES `OpenTestCenterDB`.`Suite` (`SuiteID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `Priority_in_Suite`
    FOREIGN KEY (`TestPriorityInSuite` )
    REFERENCES `OpenTestCenterDB`.`Priority` (`PriorityID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`Set`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`Set` (
  `SetID` INT NOT NULL ,
  `Name` VARCHAR(45) NOT NULL ,
  `Description` VARCHAR(255) NULL ,
  `AuthorID` INT NOT NULL ,
  `SetTypeID` INT NOT NULL ,
  `RP` INT NULL ,
  `CreatedOn` DATETIME NOT NULL ,
  `LastRun` DATETIME NULL ,
  PRIMARY KEY (`SetID`) ,
  INDEX `SetTypeID_idx` (`SetTypeID` ASC) ,
  INDEX `Author_idx` (`AuthorID` ASC) ,
  INDEX `Rp_idx` (`RP` ASC) ,
  UNIQUE INDEX `SetID_UNIQUE` (`SetID` ASC) ,
  CONSTRAINT `SetType_of_Set`
    FOREIGN KEY (`SetTypeID` )
    REFERENCES `OpenTestCenterDB`.`SetType` (`SetTypeID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `Author_of_Set`
    FOREIGN KEY (`AuthorID` )
    REFERENCES `OpenTestCenterDB`.`User` (`UserID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `RP_for_Set`
    FOREIGN KEY (`RP` )
    REFERENCES `OpenTestCenterDB`.`User` (`UserID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`TestSetMap`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`TestSetMap` (
  `TSMapID` INT NOT NULL ,
  `SetID` INT NOT NULL ,
  `TestID` INT NOT NULL ,
  `TestPriorityInSet` INT NULL ,
  `ExecutionOrder` INT NOT NULL ,
  PRIMARY KEY (`TSMapID`) ,
  INDEX `SetID_idx` (`SetID` ASC) ,
  INDEX `TestID_idx` (`TestID` ASC) ,
  INDEX `TestPriorityInSet_to_Priority_idx` (`TestPriorityInSet` ASC) ,
  UNIQUE INDEX `TSMapID_UNIQUE` (`TSMapID` ASC) ,
  CONSTRAINT `Set_containing_Test`
    FOREIGN KEY (`SetID` )
    REFERENCES `OpenTestCenterDB`.`Set` (`SetID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `Test_in_Set`
    FOREIGN KEY (`TestID` )
    REFERENCES `OpenTestCenterDB`.`Test` (`TestID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `TestPriorityInSet_to_Priority`
    FOREIGN KEY (`TestPriorityInSet` )
    REFERENCES `OpenTestCenterDB`.`Priority` (`PriorityID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`History`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`History` (
  `TransactionID` INT NOT NULL ,
  `CreatedOn` DATETIME NOT NULL ,
  `ErrorCode` INT NULL ,
  `LongDesc` VARCHAR(255) NULL ,
  `ShortDesc` VARCHAR(45) NOT NULL ,
  `UserID` INT NULL ,
  PRIMARY KEY (`TransactionID`) ,
  UNIQUE INDEX `TransactionID_UNIQUE` (`TransactionID` ASC) ,
  INDEX `UserID_idx` (`UserID` ASC) ,
  CONSTRAINT `UserID_of_xaction`
    FOREIGN KEY (`UserID` )
    REFERENCES `OpenTestCenterDB`.`User` (`UserID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`TeamUserMap`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`TeamUserMap` (
  `TUMapID` INT NOT NULL ,
  `UserID` INT NULL ,
  `TeamID` INT NULL ,
  `SubTeamID` INT NULL ,
  PRIMARY KEY (`TUMapID`) ,
  INDEX `UserID_idx` (`UserID` ASC) ,
  INDEX `TeamID_idx` (`TeamID` ASC) ,
  INDEX `SubTeamID_idx` (`SubTeamID` ASC) ,
  UNIQUE INDEX `TUMapID_UNIQUE` (`TUMapID` ASC) ,
  CONSTRAINT `User_for_TUM`
    FOREIGN KEY (`UserID` )
    REFERENCES `OpenTestCenterDB`.`User` (`UserID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `Team_for_TUM`
    FOREIGN KEY (`TeamID` )
    REFERENCES `OpenTestCenterDB`.`Team` (`TeamID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `SubTeam_for_TUM`
    FOREIGN KEY (`SubTeamID` )
    REFERENCES `OpenTestCenterDB`.`SubTeam` (`SubTeamID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`AcceptanceToPayloadMap`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`AcceptanceToPayloadMap` (
  `ACMapID` INT NOT NULL ,
  `ACID` INT NOT NULL ,
  `PayloadID` INT NOT NULL ,
  `RP` INT NOT NULL ,
  `BeganWorkOn` DATETIME NULL ,
  `FinishedWorkOn` DATETIME NULL ,
  `Comments` VARCHAR(128) NULL ,
  PRIMARY KEY (`ACMapID`) ,
  UNIQUE INDEX `ACMapID_UNIQUE` (`ACMapID` ASC) ,
  INDEX `AC_in_Payload_idx` (`ACID` ASC) ,
  INDEX `This_Payload_idx` (`PayloadID` ASC) ,
  INDEX `RP_for_This_AC_idx` (`RP` ASC) ,
  CONSTRAINT `AC_in_Payload`
    FOREIGN KEY (`ACID` )
    REFERENCES `OpenTestCenterDB`.`AcceptanceCriterion` (`ACID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `Payload_containing_AC`
    FOREIGN KEY (`PayloadID` )
    REFERENCES `OpenTestCenterDB`.`Payload` (`PayloadID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `RP_for_This_AC_in_This_Payload`
    FOREIGN KEY (`RP` )
    REFERENCES `OpenTestCenterDB`.`User` (`UserID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`BugFixSet`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`BugFixSet` (
  `BugFixSetID` INT NOT NULL ,
  `BugFixSetName` VARCHAR(64) NULL ,
  `RP` INT NULL ,
  `DeliveredOn` DATETIME NULL ,
  `ExpectedOn` DATETIME NULL ,
  `SubTeamID` INT NULL ,
  `ShortDesc` VARCHAR(255) NULL ,
  `LongDesc` VARCHAR(1024) NULL ,
  `AssociatedBuild` INT NULL ,
  PRIMARY KEY (`BugFixSetID`) ,
  UNIQUE INDEX `BugFixSetID_UNIQUE` (`BugFixSetID` ASC) ,
  INDEX `RP_for_BFSet_idx` (`RP` ASC) ,
  INDEX `SubTeam_owning_BFSet_idx` (`SubTeamID` ASC) ,
  INDEX `Build_containting_BFS_idx` (`AssociatedBuild` ASC) ,
  CONSTRAINT `RP_for_BFSet`
    FOREIGN KEY (`RP` )
    REFERENCES `OpenTestCenterDB`.`User` (`UserID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `SubTeam_owning_BFSet`
    FOREIGN KEY (`SubTeamID` )
    REFERENCES `OpenTestCenterDB`.`SubTeam` (`SubTeamID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `Build_containting_BFS`
    FOREIGN KEY (`AssociatedBuild` )
    REFERENCES `OpenTestCenterDB`.`Build` (`BuildID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`BugToBugFixSetMap`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`BugToBugFixSetMap` (
  `BugMapID` INT NOT NULL ,
  `BugID` INT NOT NULL ,
  `BugFixSetID` INT NOT NULL ,
  `RP` INT NULL ,
  `OpenedOn` DATETIME NULL ,
  `ClosedOn` DATETIME NULL ,
  `Comments` VARCHAR(128) NULL ,
  PRIMARY KEY (`BugMapID`) ,
  UNIQUE INDEX `BugMapID_UNIQUE` (`BugMapID` ASC) ,
  INDEX `Bug_In_BFS_idx` (`BugID` ASC) ,
  INDEX `BFS_Containing_Bug_idx` (`BugFixSetID` ASC) ,
  INDEX `RP_of_Bug_In_BugFixSet_idx` (`RP` ASC) ,
  CONSTRAINT `Bug_In_BFS`
    FOREIGN KEY (`BugID` )
    REFERENCES `OpenTestCenterDB`.`Bug` (`BugID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `BFS_Containing_Bug`
    FOREIGN KEY (`BugFixSetID` )
    REFERENCES `OpenTestCenterDB`.`BugFixSet` (`BugFixSetID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `RP_of_Bug_In_BugFixSet`
    FOREIGN KEY (`RP` )
    REFERENCES `OpenTestCenterDB`.`User` (`UserID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`Anatomy`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`Anatomy` (
  `AnatomyID` INT NOT NULL ,
  `ReleaseID` INT NULL ,
  `AnatomyName` VARCHAR(45) NOT NULL ,
  `AnatomyDesc` VARCHAR(255) NULL ,
  PRIMARY KEY (`AnatomyID`) ,
  INDEX `Release_Containing_Anatomy_idx` (`ReleaseID` ASC) ,
  CONSTRAINT `Release_Containing_Anatomy`
    FOREIGN KEY (`ReleaseID` )
    REFERENCES `OpenTestCenterDB`.`Release` (`ReleaseID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`AnatomyDependMap`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`AnatomyDependMap` (
  `AnatomyMapID` INT NOT NULL ,
  `ThisAnatomyID` INT NOT NULL ,
  `ThatAnatomyID` INT NOT NULL ,
  PRIMARY KEY (`AnatomyMapID`) ,
  INDEX `AnatomyMap_to_Anatomy_idx` (`ThisAnatomyID` ASC) ,
  INDEX `AnatomyMap_Dependency_idx` (`ThatAnatomyID` ASC) ,
  CONSTRAINT `AnatomyMap_Anatomy_Value`
    FOREIGN KEY (`ThisAnatomyID` )
    REFERENCES `OpenTestCenterDB`.`Anatomy` (`AnatomyID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `AnatomyMap_Dependency`
    FOREIGN KEY (`ThatAnatomyID` )
    REFERENCES `OpenTestCenterDB`.`Anatomy` (`AnatomyID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`AnatomyTestMap`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`AnatomyTestMap` (
  `TestAnatomyMapID` INT NOT NULL ,
  `ThisAnatomy` INT NOT NULL ,
  `CoveredByThatTest` INT NOT NULL ,
  PRIMARY KEY (`TestAnatomyMapID`) ,
  UNIQUE INDEX `TestAnatomyMapID_UNIQUE` (`TestAnatomyMapID` ASC) ,
  INDEX `AnatomyMapPart_idx` (`ThisAnatomy` ASC) ,
  INDEX `AnatomyTestCovering_idx` (`CoveredByThatTest` ASC) ,
  CONSTRAINT `AnatomyMapPart`
    FOREIGN KEY (`ThisAnatomy` )
    REFERENCES `OpenTestCenterDB`.`Anatomy` (`AnatomyID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `AnatomyTestCovering`
    FOREIGN KEY (`CoveredByThatTest` )
    REFERENCES `OpenTestCenterDB`.`Test` (`TestID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`Relationship`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`Relationship` (
  `RelationshipID` INT NOT NULL COMMENT 'A relationship is a description of a common property shared by a group of entities (bugs, tests, stories, or relationships).' ,
  `Name` VARCHAR(64) NOT NULL ,
  `Comments` VARCHAR(255) NULL ,
  PRIMARY KEY (`RelationshipID`) )
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`AssociateMap`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`AssociateMap` (
  `AssociateID` INT NOT NULL COMMENT 'An association is a causal link between one entity and another.  \\n\\nEG, a story caused a test, which caused a bug\\na story caused a relationship to 5 other stories, which in turn caused 4 bugs.\\n\\nThis allows a story to be told and interesting metrics to be calculated.' ,
  `ThisBug` INT NULL ,
  `ThisStory` INT NULL ,
  `ThisRelationship` INT NULL ,
  `ThisTest` INT NULL ,
  `ThatBug` INT NULL ,
  `ThatStory` INT NULL ,
  `ThatRelationship` INT NULL ,
  `ThatTest` INT NULL ,
  `Comments` VARCHAR(255) NULL ,
  PRIMARY KEY (`AssociateID`) ,
  UNIQUE INDEX `FriendID_UNIQUE` (`AssociateID` ASC) ,
  INDEX `That_bug_is_a_friend_in_bug_table_idx` (`ThisBug` ASC) ,
  INDEX `That_bug_in_relatemap_idx` (`ThatBug` ASC) ,
  INDEX `This_story_in_relatemap_idx` (`ThisStory` ASC) ,
  INDEX `That_story_in_relatemap_idx` (`ThatStory` ASC) ,
  INDEX `This_test_in_relatemap_idx` (`ThisTest` ASC) ,
  INDEX `That_test_in_relatemap_idx` (`ThatTest` ASC) ,
  INDEX `This_relationship_in_associatemap_idx` (`ThisRelationship` ASC) ,
  INDEX `That_relationship_in_associatemap_idx` (`ThatRelationship` ASC) ,
  CONSTRAINT `This_bug_in_associatemap`
    FOREIGN KEY (`ThisBug` )
    REFERENCES `OpenTestCenterDB`.`Bug` (`BugID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `That_bug_in_associatemap`
    FOREIGN KEY (`ThatBug` )
    REFERENCES `OpenTestCenterDB`.`Bug` (`BugID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `This_story_in_associatemap`
    FOREIGN KEY (`ThisStory` )
    REFERENCES `OpenTestCenterDB`.`Story` (`StoryID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `That_story_in_associatemap`
    FOREIGN KEY (`ThatStory` )
    REFERENCES `OpenTestCenterDB`.`Story` (`StoryID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `This_test_in_associatemap`
    FOREIGN KEY (`ThisTest` )
    REFERENCES `OpenTestCenterDB`.`Test` (`TestID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `That_test_in_associatemap`
    FOREIGN KEY (`ThatTest` )
    REFERENCES `OpenTestCenterDB`.`Test` (`TestID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `This_relationship_in_associatemap`
    FOREIGN KEY (`ThisRelationship` )
    REFERENCES `OpenTestCenterDB`.`Relationship` (`RelationshipID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `That_relationship_in_associatemap`
    FOREIGN KEY (`ThatRelationship` )
    REFERENCES `OpenTestCenterDB`.`Relationship` (`RelationshipID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `OpenTestCenterDB`.`RelationshipMap`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `OpenTestCenterDB`.`RelationshipMap` (
  `RelationshipMapID` INT NOT NULL COMMENT 'Map an entity to a relationship.' ,
  `RelationshipID` INT NULL ,
  `ThisTest` INT NULL ,
  `ThisBug` INT NULL ,
  `ThisStory` INT NULL ,
  `ThisRelationship` INT NULL ,
  PRIMARY KEY (`RelationshipMapID`) ,
  INDEX `ThisRelationship_in_relationshipmap_idx` (`ThisRelationship` ASC) ,
  INDEX `ThisTest_in_relationshipmap_idx` (`ThisTest` ASC) ,
  INDEX `ThisBug_in_relationshipmap_idx` (`ThisBug` ASC) ,
  INDEX `ThisStory_in_relationshipmap_idx` (`ThisStory` ASC) ,
  INDEX `RelationshipID_in_relationshipmap_idx` (`RelationshipID` ASC) ,
  CONSTRAINT `ThisRelationship_in_relationshipmap`
    FOREIGN KEY (`ThisRelationship` )
    REFERENCES `OpenTestCenterDB`.`Relationship` (`RelationshipID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `ThisTest_in_relationshipmap`
    FOREIGN KEY (`ThisTest` )
    REFERENCES `OpenTestCenterDB`.`Test` (`TestID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `ThisBug_in_relationshipmap`
    FOREIGN KEY (`ThisBug` )
    REFERENCES `OpenTestCenterDB`.`Bug` (`BugID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `ThisStory_in_relationshipmap`
    FOREIGN KEY (`ThisStory` )
    REFERENCES `OpenTestCenterDB`.`Story` (`StoryID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `RelationshipID_in_relationshipmap`
    FOREIGN KEY (`RelationshipID` )
    REFERENCES `OpenTestCenterDB`.`Relationship` (`RelationshipID` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;



SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
